<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset=UTF-8"utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>
            Laravel Administrator Documentation                            : Settings Configuration                    </title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="javascript:if(confirm('http://browsehappy.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://browsehappy.com/'">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div class="wrapper">
            <header>
                
                <h1>Laravel Administrator Documentation</h1>
                <div id="donateContainer">
                    <form action="javascript:if(confirm('http://administrator.frozennode.com/charge  \n\n该文件无法用 Teleport Ultra 下载, 因为 服务器报告该文件的请求方法不允许使用。  \n\n你想在服务器上打开它?'))window.location='http://administrator.frozennode.com/charge'">
                        <button id="donateButton" class="stripe-button-el">
                            <span style="display: block; min-height: 30px;">Donate</span>
                        </button>
                    </form>
                </div>
            </header>
            <aside class="sidebar">
                	<ul>
<li>Overview

<ul>
<li><a href="introduction.htm">Introduction</a></li>
<li><a href="contributing.htm">Contributing</a></li>
<li><a href="style-guide.htm">Style Guide</a></li>
<li><a href="license.htm">License</a></li>
</ul></li>
<li>Getting Started

<ul>
<li><a href="installation.htm">Installation</a></li>
<li><a href="configuration.htm">Configuration</a></li>
<li><a href="model-configuration.htm">Model Configuration</a></li>
<li><a href="settings-configuration.htm">Settings Configuration</a></li>
<li><a href="validation.htm">Validation</a></li>
<li><a href="localization.htm">Localization</a></li>
<li><a href="tutorials.htm">Tutorials</a></li>
</ul></li>
<li>Custom Actions

<ul>
<li><a href="actions.htm">Overview</a></li>
</ul></li>
<li>Columns

<ul>
<li><a href="columns.htm">Overview</a></li>
<li><a href="relationship-columns.htm">Relationships</a></li>
</ul></li>
<li>Fields

<ul>
<li><a href="fields.htm">Overview</a></li>
</ul></li>
<li>Field Types

<ul>
<li><a href="field-type-key.htm">Key</a></li>
<li><a href="field-type-text.htm">Text</a></li>
<li><a href="field-type-password.htm">Password</a></li>
<li><a href="field-type-textarea.htm">TextArea</a></li>
<li><a href="field-type-wysiwyg.htm">WYSIWYG</a></li>
<li><a href="field-type-markdown.htm">Markdown</a></li>
<li><a href="field-type-relationship.htm">Relationship</a></li>
<li><a href="field-type-number.htm">Number</a></li>
<li><a href="field-type-bool.htm">Bool</a></li>
<li><a href="field-type-enum.htm">Enum</a></li>
<li><a href="field-type-date.htm">Date</a></li>
<li><a href="field-type-time.htm">Time</a></li>
<li><a href="field-type-datetime.htm">Datetime</a></li>
<li><a href="field-type-file.htm">File</a></li>
<li><a href="field-type-image.htm">Image</a></li>
<li><a href="field-type-color.htm">Color</a></li>
</ul></li>
</ul>
            </aside>
            <section class="content">
                	<h1>Settings Configuration</h1>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#options">Options</a></li>
</ul>

<p><a name="introduction"></a></p>

<h2>Introduction</h2>

<p>Sometimes you want to be able to create settings pages for your administrators. Settings pages, like <a href="model-configuration.htm"><code>menu</code></a> option in the <code>administrator.php</code> config.</p>

<blockquote>
  <p><strong>Note</strong>: These are also the uris for each settings page in the admin interface.</p>
</blockquote>

<p>There are several required fields that must be supplied in order for a settings config file to work, and there are several optional fields. <a href="#options">See the list of options below</a>.</p>

<p>Settings are saved as JSON files in the storage subdirectory <code>administrator_settings</code>. However, before a settings page is saved in one of these JSON files, the data is first passed through validation using the <a href="#validation-rules"><code>rules</code></a> that may exist, and then to the <a href="#before-save"><code>before_save</code></a> function where you can run any extra validation and store it however you like (e.g. write it to the database or PHP config files) for your own use within your app.</p>

<p><a name="examples"></a></p>

<h2>Examples</h2>

<p>For some example config files, check out the <code>/examples</code> directory on <a href="javascript:if(confirm('https://github.com/FrozenNode/Laravel-Administrator/tree/master/examples  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/FrozenNode/Laravel-Administrator/tree/master/examples'">Administrator's GitHub repo</a>.</p>

<p><a name="options"></a></p>

<h2>Options</h2>

<p>Below is a list of all the available options for settings pages. Required options are marked as <em>(required)</em>:</p>

<ul>
<li><a href="#title">Title</a> <em>(required)</em></li>
<li><a href="#edit-fields">Edit Fields</a> <em>(required)</em></li>
<li><a href="#validation-rules">Validation Rules</a></li>
<li><a href="#before-save">Before Save</a></li>
<li><a href="#permission">Permission</a></li>
<li><a href="#custom-actions">Custom Actions</a></li>
<li><a href="#storage-path">Storage Path</a></li>
</ul>

<p><a name="title"></a></p>

<h3>Title <em>(required)</em></h3>

<pre><code>/**
 * Settings page title
 *
 * @type string
 */
'title' =&gt; 'Site Settings',
</code></pre>

<p>This is the title of the settings page used in the menu and as the page's primary title.</p>

<p><a name="edit-fields"></a></p>

<h3>Edit Fields <em>(required)</em></h3>

<pre><code>/**
 * The edit fields array
 *
 * @type array
 */
'edit_fields' =&gt; array(
    'site_name' =&gt; array(
        'title' =&gt; 'Name',
        'type' =&gt; 'text',
    ),
    'page_cache_lifetime' =&gt; array(
        'title' =&gt; 'Page Cache Lifetime (in minutes)',
        'type' =&gt; 'number',
    ),
    'logo' =&gt; array(
        'title' =&gt; 'Image (200 x 150)',
        'type' =&gt; 'image',
        'naming' =&gt; 'random',
        'location' =&gt; 'public/uploads/config/logo/originals/',
        'size_limit' =&gt; 2,
        'sizes' =&gt; array(
            array(200, 150, 'crop', 'public/uploads/config/logo/resize/', 100),
        )
    )
),
</code></pre>

<p>The <code>edit_fields</code> array lets you define the editable fields for a settings page. All field types are allowed with the exception of key and relationship fields. This works much like the <a href="model-configuration.htm#edit-fields"><code>before_save callback</code></a> containing all of your data. The indexes of the data values will be the same as the indexes you provide in the <code>edit_fields</code> array.</p>

<p><img src="../../raw.githubusercontent.com/FrozenNode/Laravel-Administrator/master/examples/images/settings-overview.png" /></p>

<blockquote>
  <p>For a detailed description of all the edit field types and options, see the <strong><a href="fields.htm">field docs</a></strong></p>
</blockquote>

<p><a name="validation-rules"></a></p>

<h3>Validation Rules</h3>

<pre><code>/**
 * The validation rules for the form, based on the Laravel validation class
 *
 * @type array
 */
'rules' =&gt; array(
    'site_name' =&gt; 'required|max:50',
    'site_email' =&gt; 'required|email',
),
</code></pre>

<p>The validation rules for your settings page can be set using the <code>rules</code> option. Administrator uses <a href="javascript:if(confirm('http://laravel.com/docs/validation  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://laravel.com/docs/validation'">Laravel's validation</a> to validate your models. If the form is invalid, it will notify the admin without saving the form.</p>

<p><a name="before-save"></a></p>

<h3>Before Save</h3>

<pre><code>/**
 * This is run prior to saving the JSON form data
 *
 * @type function
 * @param array     $data
 *
 * @return string (on error) / void (otherwise)
 */
'before_save' =&gt; function(&amp;$data)
{
    if (today_is_tuesday())
    {
        return "Sorry, site settings can't be saved on Tuesday";
    }

    $data['site_name'] = $data['site_name'] . ' - The Blurst Site Ever';
},
</code></pre>

<p>The <code>before_save</code> callback is run after basic validation using the <a href="#validation-rules"><code>rules</code></a> option, but before the form data is saved to the JSON storage. You can use this function to store the data however you want. Since the <code>$data</code> parameter is passed by reference, you can also manipulate the form data prior to it being saved.</p>

<p>The <code>$data</code> parameter is a simple array of <code>key -&gt; value</code> pairs. The keys are the same as those provided in the <a href="#edit-fields"><code>edit_fields</code></a> option.</p>

<p><a name="permission"></a></p>

<h2>Permission</h2>

<pre><code>/**
 * The permission option is an authentication check that lets you define a closure that should return true if the current user
 * is allowed to view this settings page. Any "falsey" response will result in a 404.
 *
 * @type closure
 */
'permission'=&gt; function()
{
    return Auth::user()-&gt;has_role('developer');
},
</code></pre>

<p>The permission option lets you define a closure that determines whether or not the current user can access this settings page. If this field is provided (it isn't required), the user will only be given access if this resolves to a truthy value. If this fails, the user will be given a 404.</p>

<p><a name="custom-actions"></a></p>

<h2>Custom Actions</h2>

<pre><code>/**
 * This is where you can define the settings page's custom actions
 */
'actions' =&gt; array(
    //Ordering an item up
    'clear_page_cache' =&gt; array(
        'title' =&gt; 'Clear Page Cache',
        'messages' =&gt; array(
            'active' =&gt; 'Clearing cache...',
            'success' =&gt; 'Page Cache Cleared',
            'error' =&gt; 'There was an error while clearing the page cache',
        ),
        //the settings data is passed to the closure and saved if a truthy response is returned
        'action' =&gt; function(&amp;$data)
        {
            Cache::forget('pages');

            return true;
        }
    ),

    //Fetch spot prices from a data API
    'get_spot_prices' =&gt; array(...),
),
</code></pre>

<p>You can define custom actions for your settings page if you want to provide the administrative user buttons to perform custom code. In the above example, there will be two buttons produced that look like this:</p>

<p><img src="../../raw.githubusercontent.com/FrozenNode/Laravel-Administrator/master/examples/images/custom-actions-settings.png" /></p>

<p>When the user clicks on either button, the <code>action</code> property for that button is called. The currently-saved settings data is passed into the function by reference with the <code>$data</code> parameter. This means that you can change the data however you like prior to it being saved in the JSON.</p>

<blockquote>
  <p>For a detailed description of custom actions, see the <strong><a href="actions.htm">actions docs</a></strong>.</p>
</blockquote>

<p><a name="storage-path"></a></p>

<h3>Storage Path</h3>

<pre><code>/**
 * The storage path in which to save the raw settings data
 *
 * @type string
 */
'storage_path' =&gt; storage_path() . '/my_custom_directory',
</code></pre>

<p>You can optionally provide a <code>storage_path</code> option that will determine in which directory the raw settings data will be saved. If you've saving the data via other means in the <code>before_save</code> callback, or if you're comfortable with the default location (<code>/app/storage/administrator_settings</code>), you can omit this option.</p>
                <nav>
                                    <a href="model-configuration.htm">鈫?Model Configuration</a> |
                                                    <a href="validation.htm">Validation 鈫?/a>
                                </nav>
                <footer>
                    <p><a href="javascript:if(confirm('http://github.com/daylerees/docs-reader  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://github.com/daylerees/docs-reader'">Dayle Rees</a>.</p>
                </footer>
            </section>
            <div class="clearfix"></div>
        </div>

        <script src="../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../js/vendor/jquery-1.8.2.min.js"/*tpa=http://administrator.frozennode.com/js/vendor/jquery-1.8.2.min.js*/><\/script>')</script>
        <script src="../../checkout.stripe.com/v2/checkout.js"></script>
        <script src="../js/vendor/prettify.js"></script>
        <script src="../js/plugins.js"></script>
        <script src="../js/main.js"></script>

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-37898177-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www/') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
    </body>
</html>